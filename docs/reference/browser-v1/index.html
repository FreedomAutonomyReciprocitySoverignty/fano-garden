<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Browser-v1 Spec | fano-garden</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400;600&family=IBM+Plex+Sans:wght@500;600;700&family=Source+Serif+4:wght@400;600;700&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="../../assets/site/styles.css" />
    <script defer src="../../assets/site/base-path.js"></script>
  </head>
  <body>
    <main class="site">
      <nav class="nav">
        <a data-nav-path="/">Home</a>
        <a data-nav-path="/quickstart/">Quickstart</a>
        <a data-nav-path="/demo/">Live Demo</a>
        <a data-nav-path="/reference/">Reference</a>
      </nav>
      <article class="doc">
        <h1>Reference Implementation: Browser-First v1</h1>
        <p>Status: normative source of truth for v1 behavior.</p>

        <h2>Scope</h2>
        <ul>
          <li>Local-first browser execution.</li>
          <li>Append-only NDJSON event log.</li>
          <li>Hash-linked commits with signatures.</li>
          <li>WebRTC DataChannel peer synchronization.</li>
          <li>Dual projection targets: SVG and Three.js transforms.</li>
        </ul>

        <h2>Canonical Architecture</h2>
        <ol>
          <li>Identity layer: public derivation mapping to 7 Fano vertices.</li>
          <li>Geometry layer: parse canonical SVG into 7 points and 7 lines.</li>
          <li>Runtime layer: edges/faces/centroid + stop metric evaluation.</li>
          <li>Persistence layer: NDJSON append with <code>prev_hash</code> -> <code>self_hash</code>.</li>
          <li>Network layer: local-first gossip and deterministic merge.</li>
          <li>Projection layer: equivalent topology in SVG and Three targets.</li>
        </ol>

        <h2>Normative Deterministic Rules</h2>
        <ul>
          <li>R1: vertex ordering by explicit label, else <code>(y asc, x asc)</code>, then DOM order tie-break.</li>
          <li>R2: fixed HD path template <code>m/44'/60'/0'/0/{i}</code>.</li>
          <li>R3: canonical Fano line table (7 fixed triples).</li>
          <li>R4: <code>closure_ratio = F_pass/7</code>, <code>stop_metric = closure_ratio</code>, <code>sabbath = stop_metric==1.0</code>.</li>
          <li>R5: commit validity requires typed fields, signature, hash continuity, hash match, deterministic face/centroid consistency.</li>
          <li>R6: merge ordering by causal graph, then <code>lc</code>, then timestamp, then lexical ids/hashes.</li>
        </ul>

        <h2>Security Requirements</h2>
        <ul>
          <li>No mnemonic/private keys/xprv in NDJSON, sync payloads, logs, or UI state.</li>
          <li>Unsigned/tampered records must be quarantined.</li>
          <li>Only public keys/addresses are runtime-safe artifacts.</li>
        </ul>

        <h2>Versioning</h2>
        <p>Spec identifier: <code>browser-v1</code>. Backward-incompatible changes require <code>browser-v2</code>.</p>

        <p>Full source: <a href="https://github.com/FreedomAutonomyReciprocitySoverignty/fano-garden/blob/main/dev-docs/reference-implementation-browser-v1.md">dev-docs/reference-implementation-browser-v1.md</a></p>
      </article>
    </main>
  </body>
</html>
